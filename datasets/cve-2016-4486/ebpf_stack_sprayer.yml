rule:
  meta:
    name: eBPF stack sprayer hints (socket filter + SO_ATTACH_BPF)
    namespace: cve/linux/ebpf
    authors: [yeajongcheol]
    scopes: { static: function, dynamic: unsupported }
    tags: [cve-2016-4486, ebpf, socket_filter]
  features:
    - and:
      - number: 0x1        # BPF_PROG_TYPE_SOCKET_FILTER
      - number: 0x5        # BPF_PROG_LOAD
      - number: 0x32       # SO_ATTACH_BPF
      - or:
        - string: "bpf prog load error"
        - string: "setsockopt error"
        - string: "SO_ATTACH_BPF"
