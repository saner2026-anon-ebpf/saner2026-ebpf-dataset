rule:
  meta:
    name: setsockopt SO_ATTACH_FILTER (CVE-2023-0597 indicator)
    namespace: communication/socket
    authors:
      - AI Assistant
    scopes:
      static: function
      dynamic: unsupported
    mbc:
      - Communication::Socket Communication::Set Socket Config [C0001.011]
    references:
      - https://nvd.nist.gov/vuln/detail/CVE-2023-0597
  features:
    - and:
      - or:
        - number: 54 = setsockopt syscall
        - number: 0x36
      - or:
        - number: 26 = SO_ATTACH_FILTER
        - number: 0x1A
      - mnemonic: syscall
