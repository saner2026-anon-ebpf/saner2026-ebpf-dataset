
rule:
  meta:
    name: CVE-2023-0597 cpu_entry_area write gadget + eBPF (numeric composite v2)
    namespace: cve/linux/cpu_entry_area
    authors: [yeajongcheol]
    scopes: { static: file, dynamic: unsupported }
    tags: [cve-2023-0597, cpu_entry_area, ebpf, numeric]
  features:
    - and:
      # 기존 핵심 축들
      - match: fs canary access (0597 anchor)
      - match: argprep rbp-0xa0 before write (0597)
      - match: PoC scaffold APIs (0597)
      # eBPF 존재를 '숫자 앵커'로 강제 (optional)
      - optional:
        - match: bpf_prog_load wrapper (0597 numeric anchors)
      - optional:
        - match: bpf map ops (lookup/update) (0597 numeric anchors)
