rule:
  meta:
    name: CVE-2023-0597 netfilter nf_tables use-after-free
    namespace: exploit/cve/linux-kernel
    authors:
      - AI Assistant
    scopes:
      static: file
      dynamic: unsupported
    att&ck:
      - Privilege Escalation::Exploitation for Privilege Escalation [T1068]
    mbc:
      - Impact::Exploit Public-Facing Application [B0035]
    references:
      - https://nvd.nist.gov/vuln/detail/CVE-2023-0597
      - https://googleprojectzero.github.io/0days-in-the-wild/
  features:
    - and:
      - match: socketpair AF_UNIX SOCK_DGRAM (CVE-2023-0597 indicator)
      - or:
        - match: setsockopt SO_ATTACH_FILTER (CVE-2023-0597 indicator)
        - match: sendmsg syscall (CVE-2023-0597 indicator)
      - or:
        - match: unshare CLONE_NEWNET (CVE-2023-0597 indicator)
        - match: memfd_create syscall (CVE-2023-0597 indicator)
