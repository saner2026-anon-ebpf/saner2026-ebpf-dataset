rule:
  meta:
    name: BPF attach to socket (CVE-2017-16995 variant 1)
    namespace: cve/linux/bpf/16995
    authors:
      - yeajongcheol
    scopes:
      static: file
      dynamic: unsupported
    description: >
      CVE-2017-16995 variant attaching BPF to socket.
  features:
    - and:
      - match: bpf syscall (api-based)
      - match: setsockopt syscall (api-based)
      - or:
        - substring: "attach"
        - substring: "SO_ATTACH"
