rule:
  meta:
    name: has setsockopt indicator (CVE-2017-16995 indicator)
    namespace: cve/linux/bpf/16995
    authors:
      - yeajongcheol
    scopes:
      static: file
      dynamic: unsupported
    description: >
      Binary has setsockopt syscall for SO_ATTACH_BPF.
  features:
    - or:
      - match: setsockopt syscall by number (CVE-2017-16995 indicator)
      - match: setsockopt syscall (api-based)
