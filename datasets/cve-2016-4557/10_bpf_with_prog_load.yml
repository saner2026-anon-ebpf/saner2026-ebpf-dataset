rule:
  meta:
    name: BPF syscall with PROG_LOAD (CVE-2016-4557 core)
    namespace: cve/linux/bpf/4557
    authors:
      - yeajongcheol
    scopes:
      static: file
      dynamic: unsupported
    tags:
      - cve-2016-4557
      - bpf
    description: >
      Core BPF usage pattern for CVE-2016-4557.
      Replaces overly-specific 0x18+0x1 adjacency pattern.

      Analysis shows 15/15 samples use: bpf(321) + PROG_LOAD(5)
  features:
    - and:
      # BPF syscall
      - match: bpf syscall (multi-arch)

      # BPF_PROG_LOAD command
      - match: BPF_PROG_LOAD command (5)
