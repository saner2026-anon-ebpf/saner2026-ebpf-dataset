rule:
  meta:
    name: CVE-2022-23222
    namespace: exploit/cve/linux-kernel/bpf
    authors:
      - yeajongcheol
    scopes:
      static: file
      dynamic: unsupported
    tags:
      - cve-2022-23222
      - bpf
      - ringbuf
    references:
      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-23222
    description: >
      CVE-2022-23222: BPF verifier bypass via ringbuf operations.
      Binary analysis: RINGBUF is decisive.
  features:
    - and:
      # DECISIVE: BPF_MAP_TYPE_RINGBUF
      - match: BPF_MAP_TYPE_RINGBUF (CVE-2022-23222 indicator)

      # REQUIRED: ringbuf operations
      - match: BPF_FUNC_ringbuf_reserve (CVE-2022-23222 indicator)
